<<<<<<< HEAD
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
</head>
<body>
    <div id="content">
        <div id="input">
            <form id="form-query" action="submit">
                <label for="query">Query: </label>
                <input id="query" name="query" type="text">
                <label for="calories">Calories per day: </label>
                <input id="calories" name="calories" type="text">
                <input type="submit" value="Search">
            </form>
            <form id="form-calories" action="submit">
                <label for="weight">*Weight: </label>
                <input id="weight" name="weight" type="text">
                <label for="height">*Height: </label>
                <input id="height" name="height" type="text">
                <label for="age">*Age: </label>
                <input id="age" name="age" type="text">
                <label for="gender">*Gender: </label>
                <input id="gender" name="gender" type="text">
                <label for="activity-level">Activity level: </label>
                <input id="activity-level" name="activity-level" type="text">
                <label for="body-fat">Body fat: </label>
                <input id="body-fat" name="body-fat" type="text">
                <input type="submit" value="Calculate">
            </form>
        </div>
        <div id="output"></div>
    </div>

    <script src="./api.js"></script>
    <script>
        // Temporary DOM
        const output = document.getElementById("output");
        const formQuery = {
            form: document.getElementById("form-query"),
            query: document.getElementById("query"),
            inputCalories: document.getElementById("calories")
        }
        const formCalories = {
            form: document.getElementById("form-calories"),
            weight: document.getElementById("weight"),
            height: document.getElementById("height"),
            age: document.getElementById("age"),
            gender: document.getElementById("gender"),
            activityLevel: document.getElementById("activity-level"),
            bodyFat: document.getElementById("body-fat")
        }
        let input = {};
        let recipes = [];
        
        const updateRecipes = () => {
            output.innerHTML = '';
            recipes.forEach(r => {
                let div = document.createElement("div");
                let a = document.createElement("a");
                a.setAttribute("target", "_blank");
                a.className = "recipeLink";
                a.href = r.url;
                a.style.display = "flex";
                a.style.margin = "10px";
                a.style.alignItems = "center";
                a.style.border = "2px solid black";
                let image = document.createElement("img");
                image.setAttribute("src", r.image);
                image.style.height = "150px";
                image.style.padding = "10px";
                let label = document.createElement("a");
                label.innerHTML = r.label + ': ' + Math.floor(r.calories / r.yield) + ' calories / serving';
                label.style.fontSize = "30px";

                a.append(image, label);
                div.appendChild(a);
                output.appendChild(div);
            })
        }

        formQuery.form.onsubmit = async e => {
            e.preventDefault();
            let calories = caloriesLocal(formQuery.inputCalories.value);
            const caloriesPerDish = {
                breakfast: calories * 0.25,
                snack1: calories * 0.15,
                lunch: calories * 0.30,
                dinner: calories * 0.20,
                snack2: calories * 0.1
            }
            recipes = [];
            promises = [];
            for (const cal in caloriesPerDish) {
                let rand = Math.floor(Math.random() * 100);
                promises.push(RecipeAPI.fetchRecipes(formQuery.query.value, {
                    from: rand, 
                    to: rand+1, 
                    calories: Math.floor(0.95 * caloriesPerDish[cal]) + '-' + Math.floor(1.05 * caloriesPerDish[cal])
                })
                .then((r) => {recipes.push(r[0]);})
                .catch(err => console.log(err)));
            }
            await Promise.all(promises);
            updateRecipes();
        }
        
        formCalories.form.onsubmit = e => {
            e.preventDefault();
            formQuery.inputCalories.value = calorieCalculator(formCalories.weight.value, formCalories.height.value, formCalories.age.value, formCalories.gender.value, formCalories.activityLevel.value, formCalories.bodyFat.value);
            
            localStorage.setItem('weight', formCalories.weight.value);
            localStorage.setItem('height', formCalories.height.value);
            localStorage.setItem('age', formCalories.age.value);
            localStorage.setItem('gender', formCalories.gender.value);
            localStorage.setItem('activityLevel', formCalories.activityLevel.value);
            localStorage.setItem('bodyFat', formCalories.bodyFat.value);
        }

        formQuery.inputCalories.value = caloriesLocal();
        formCalories.weight.value = localStorage.getItem('weight');
        formCalories.height.value = localStorage.getItem('height');
        formCalories.age.value = localStorage.getItem('age');
        formCalories.gender.value = localStorage.getItem('gender');
        formCalories.activityLevel.value = localStorage.getItem('activityLevel');
        formCalories.bodyFat.value = localStorage.getItem('bodyFat');

    </script>
=======
<!doctype html>

<html lang="en">
<head>
  <meta charset="utf-8">

  <title>The HTML5 Herald</title>
  <meta name="description" content="The HTML5 Herald">
  <meta name="author" content="SitePoint">

</head>

<body>
        <div id="content">
                <div id="input">
                    <form id="form-query" action="submit">
                        <label for="query">Query: </label>
                        <input id="query" name="query" type="text">
                        <label for="calories">Calories per day: </label>
                        <input id="calories" name="calories" type="text">
                        <input type="submit" value="Search">
                    </form>
                    <form id="form-calories" action="submit">
                        <label for="weight">*Weight: </label>
                        <input id="weight" name="weight" type="text">
                        <label for="height">*Height: </label>
                        <input id="height" name="height" type="text">
                        <label for="age">*Age: </label>
                        <input id="age" name="age" type="text">
                        <label for="gender">*Gender: </label>
                        <input id="gender" name="gender" type="text">
                        <label for="activity-level">Activity level: </label>
                        <input id="activity-level" name="activity-level" type="text">
                        <label for="body-fat">Body fat: </label>
                        <input id="body-fat" name="body-fat" type="text">
                        <input type="submit" value="Calculate">
                    </form>
                </div>
                <div id="output"></div>
  <script src="api.js"></script>
>>>>>>> api
</body>
</html>